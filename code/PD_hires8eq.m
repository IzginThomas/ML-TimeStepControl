%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% ODE Solver Test Suite                                               %%%
%%%                                                                     %%%
%%% Author: Thomas Izgin (izgin@mathematik.uni-kassel.de)             %%%
%%% Date: 09/29/2022                                                    %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% HIRES problem                                                   %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function [P, D, f, S, r, Rrem,Rminus] = PD_hires8eq(t,y,varargin)

k1 = 1.71;
k2 = 0.43;
k3 = 8.32;
k4 = 0.69;
k5 = 0.035;
k6 = 280;
k7 = 1.81;

r1p = @(y) 0.0007;
r5p = @(y) k2*y(7,:);
r6p = @(y) k4*y(7,:);

r6d = @(y) k6.*y(6,:).*y(8,:);


P(1,2) = k2*y(2,:); %k2 = 0.43;
P(1,3) = k3*y(3,:); %k3 = 8.32;
P(2,1) = k1*y(1,:); %k1 = 1.71;
P(3,4) = k2*y(4,:);%k2 = 0.43;
P(3,5) = k5*y(5,:);%k5 = 0.035;
P(4,2) = k3*y(2,:);%k3 = 8.32;
P(4,3) = k1*y(3,:);%k1 = 1.71;
P(5,6) = k2*y(6,:);%k2 = 0.43;
P(6,4) = k4*y(4,:);%k4 = 0.69;
P(6,5) = k1*y(5,:);%k1 = 1.71;
P(7,8) = k6.*y(6,:).*y(8,:);%k6 = 280;
P(8,7) = k7*y(7,:);%k7 = 1.81;



     
D = P';

%% P(1,2) = k2*y(2);
%% P(1,3) = k3*y(3);
%% P(2,1) = k1*y(1);
%% P(3,4) = k2*y(4);
%% P(3,5) = k5*y(5);
%% P(4,2) = k3*y(2);
%% P(4,3) = k1*y(3);
%% P(5,6) = k2*y(6);
%% P(6,4) = k4*y(4);
%% P(6,5) = k1*y(5);
%% P(7,8) = k6*y(6)*y(8);
%% P(8,7) = k7*y(7);
if nargout > 2
f = @(t,y) [r1p(y) + k2*y(2,:) + k3*y(3,:) - k1*y(1,:);
           k1*y(1,:) - (k2*y(2,:) + k3*y(2,:));
           k2*y(4,:) + k5*y(5,:) - (k1*y(3,:) + k3*y(3,:));
           k3*y(2,:) + k1*y(3,:) - (k2*y(4,:) + k4*y(4,:));
           k2*y(6,:) + r5p(y) - (k1*y(5,:) + k5*y(5,:));%
           k1*y(5,:) + r6p(y) + k4*y(4,:) - (k2*y(6,:) + r6d(y));
           k6*y(6,:).*y(8,:) - (k7*y(7,:));
           k7*y(7,:) - k6*y(6,:).*y(8,:)];
end

if nargout > 3 %% Need to be done
 S=zeros(length(y));
  
  
   r = @(y) zeros(length(y),1);

end


% r1p = @(y) 0.0007;
% r5p = @(y) k2*y(7);
% r6p = @(y) k4*y(7);
% r6d = @(y) k6*y(6)*y(8);
if nargout > 5 

Rrem = zeros(length(y),1); % remainder
Rminus = Rrem;
Rminus(6) = r6d(y);
Rrem(1) = r1p(y);
Rrem(5) = r5p(y);
Rrem(6) = r6p(y);
end

